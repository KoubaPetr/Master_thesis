length(virulence_proportion_aai_inf_30_aoi[inf_lifespan_aai_30[5]-30])
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
### histograms of death distributions for respective aai classes
pdf("Overall_distribution_of_deaths.pdf")
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE, main = "Overall distribution of deaths", xlab = "Age of infection [Days]")
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend("topright", bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
dev.off()
pdf("Distribution_of_deaths_due_to_virulence.pdf")
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
dev.off()
## Commparing the sample sizes with proper sizing when reflecting the deathrate
sample_sizes_for_aai_compartments <- c(length(longevity_aai_5_exp)+length(longevity_aai_5_inf),length(longevity_aai_15_exp)+length(longevity_aai_15_inf),length(longevity_aai_30_exp)+length(longevity_aai_30_inf))
expected_sample_sizes <- c(113, 113*sum(host_longevity_control>14)/sum(host_longevity_control>4), 113*sum(host_longevity_control>29)/sum(host_longevity_control>4))
expected_sample_sizes
#### TODO: ---------------------------------------------------------------------------------
### is the fit of aai_30_exp satisfactory?
### Pick correct compartment for the computation of the natural deathrate (wait for answer by Roland)
### Including what we have in our model
### Relation between lifespan distribution and virulence?
### Look for better test then Kolmogorov-Smirnov (wait for Rolands reply)
### Trying to fit with Weibull distribution?
### As stated here: https://indico.cern.ch/event/217511/contributions/444928/attachments/349287/486926/compar.pdf
# it should be fine using the KS test for cumulative distribution function (even supported in wikipedia,
# if 1-F(x) doesnt change the statistics(shouldnt!))
### Continue with improving the fit: Try moving the fit closer to the data manually,
# if it looks better but likelihood decreases, we messed up in likelihood, if likelihood increases above maximum,
# try better optimizer (bblme4,optimx)
### We could try fitting with Weibull, maybe each step in the survival individualy (so combination of two Weibul distributions),
# or combination of two quadratic functions
### Likelihood hopefully corrected, try running the whole optimization and check the control plots
### (perhaps go back to optimizing even over the first 16 years with the uninfected and whole exposed population)
### Consider computing virulence since the time of castration and check that we dont include
# in the exposed/infected population the individuals who died within 7 days after the exposure
# (infection status could not be verified so soon after exposure)
## update: Frida suggested not to use the time of castration as the time of infection,
## and I checked the infection status and there is no early death in the data, so it is fine
pchisq(LRT_lin_quadratic_uninf, df = 1, lower.tail = FALSE)
pchisq(LRT_quadratic_cub_uninf, df = 1, lower.tail = FALSE)
pchisq(LRT_cub_quartic_uninf, df = 1, lower.tail = FALSE)
virulence_aai_5 <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_uninfected_quartic)
virulence_aai_15 <- delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic) - delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_uninfected_quartic)
virulence_aai_30 <- delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic) - delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_uninfected_quartic)
virulence_aai_5 <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic)
virulence_aai_15 <- delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic) - delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic)
virulence_aai_30 <- delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic) - delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.224, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.226, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.326, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.266, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.206, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.260, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.259, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.258, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.258, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.099, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.1, 0.06), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.1, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.101, 0.06), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.101, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.06), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.06), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.07), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.073), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for exposed:", cex = 0.7)
text(45,0.17, labels = "16", cex = 0.7, col = "red")
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(45,0.17, labels = "16", cex = 0.7, col = "red")
text(46,0.17, labels = "16", cex = 0.7, col = "red")
text(47,0.17, labels = "16", cex = 0.7, col = "red")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(47,0.17, labels = "16", cex = 0.7, col = "red")
longevity_exposed
longevity_exposed > 5
longevity_exposed > 15
longevity_exposed > 30
sum(longevity_exposed > 30)
sum(longevity_exposed > 15)
sum(longevity_exposed > 5)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(47,0.17, labels = "136", cex = 0.7, col = "red")
text(51,0.17, labels = "136", cex = 0.7, col = "green")
text(57,0.17, labels = "133", cex = 0.7, col = "blue")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(47,0.17, labels = "136", cex = 0.7, col = "red")
text(55,0.17, labels = "136", cex = 0.7, col = "green")
text(65,0.17, labels = "133", cex = 0.7, col = "blue")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(20.5,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(20,0.15, labels = "Sample size for infecteds:", cex = 0.7)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(20,0.15, labels = "Sample size for infecteds:", cex = 0.7)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(18,0.15, labels = "Sample size for infecteds:", cex = 0.7)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(48,0.15, labels = "97", cex = 0.7, col = "red")
text(56,0.15, labels = "27", cex = 0.7, col = 'green')
text(66,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(48,0.15, labels = "97", cex = 0.7, col = "red")
text(56,0.15, labels = "27", cex = 0.7, col = 'green')
text(64,0.15, labels = "14", cex = 0.7, col = 'blue')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(48,0.15, labels = "97", cex = 0.7, col = "red")
text(56,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
#### Kolmogorov-Smirnov tests for survival distributions -----------------------------------
## Does Survival of control and exposed populations come from the same distribution?
ks.test(survivals_control, survivals_exposed)
ks.test(survivals_aai_5_exp[5:lifetime_threshold], survivals_aai_5_control[5:lifetime_threshold])
ks.test(survivals_aai_15_exp[15:lifetime_threshold], survivals_aai_15_control[15:lifetime_threshold]) ### Same distribution
ks.test(survivals_aai_30_exp[30:lifetime_threshold], survivals_aai_30_control[30:lifetime_threshold]) ### Same distribution
ks.test(survivals_aai_5_exp[5:lifetime_threshold], survivals_aai_5_control[5:lifetime_threshold])
#### Kolmogorov-Smirnov tests for survival distributions -----------------------------------
## Does Survival of control and exposed populations come from the same distribution?
ks.test(survivals_control, survivals_exposed)
ks.test(survivals_aai_5_exp[5:lifetime_threshold], survivals_aai_5_control[5:lifetime_threshold])
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic), x = age_axis)[1:135], col = "yellow")
# Quadratic model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:135], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic, x = age_axis))[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:135], col = "red")
legend(90,1, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:135], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic, x = age_axis))[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:135], col = "red")
legend(90,1, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:135], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic, x = age_axis))[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:135], col = "red")
legend(90,1, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
#comparing the fits of the uninfected compartment for fitting starting in different ages
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:135], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:135], col = "green")
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(90,1, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend(0,1, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend(0,0, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend(0,0.5, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend(0,0.6, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(0,0.6, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, bty="n" cex = 0.8)
#comparing the fits of the uninfected compartment for fitting starting in different ages
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, bty="n" cex = 0.8)
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, bty="n", cex = 0.8)
pdf("uninfected_population_survival_and_fit_different_starts_of_fitting.pdf")
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, bty="n", cex = 0.8)
dev.off()
virulence_aai_5_same_baseline <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_15_same_baseline <- delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic) - delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_30_same_baseline <- delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic) - delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_5_same_baseline <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_15_same_baseline <- delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic) - delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_30_same_baseline <- delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic) - delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_5_same_baseline <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
####
virulence_aai_5_same_baseline <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_uninfected_quartic)
virulence_aai_5_same_baseline <- delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic) - delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic)
virulence_aai_15_same_baseline <- delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic) - delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic)
virulence_aai_30_same_baseline <- delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic) - delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5_same_baseline, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15_same_baseline, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30_same_baseline, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5_same_baseline, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15_same_baseline, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30_same_baseline, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
pdf("Virulences_age_of_infection_structured_same_baseline.pdf")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5_same_baseline, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15_same_baseline, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30_same_baseline, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
dev.off()
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survivals_uninfected[31]/survivals_uninfected[1]*survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, bty="n", cex = 0.8)
pdf("uninfected_population_survival_and_fit_different_starts_of_fitting.pdf")
plot(x = age_axis[6:lifetime_threshold], y = survivals_uninfected[6:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Uninfected", type = "s", lwd =2)
# Linear model
lines(x = age_axis[6:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[6:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_5_quartic), x = age_axis)[1:145], col = "green")
# Cubic model
lines(x = age_axis[16:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[16:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_15_quartic), x = age_axis)[1:135], col = "blue")
# Quartic model
lines(x = age_axis[31:lifetime_threshold], y = survivals_uninfected[31]/survivals_uninfected[1]*survival_model(delta = delta(age = age_axis[31:lifetime_threshold], parameters = optimized_parameters_uninfected_aai_30_quartic), x = age_axis)[1:120], col = "red")
legend(0,0.63, legend = c("Data", 'Fitting since age = 5', "Fitting since age = 15 \n (also used in the fit of the \n whole uninfected population)", "Fitting since age 30"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, bty="n", cex = 0.8)
dev.off()
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5_same_baseline, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15_same_baseline, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30_same_baseline, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
text(68,0.17, labels = "133", cex = 0.7, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.076), col = "black", pch = 20, cex = 1.3)
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.08), col = "black", pch = 20, cex = 1.3)
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5_same_baseline, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15_same_baseline, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30_same_baseline, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.08), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
setwd("~/Documents/Master_thesis/Plots_17_december")
pdf("Virulences_age_of_infection_structured_same_baseline.pdf")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5_same_baseline, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15_same_baseline, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30_same_baseline, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.08), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
dev.off()
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
pdf("Virulences_age_of_infection_structured_same_model_for_same_infection_status.pdf")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.257, 0.102, 0.074), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for uninfected:", cex = 0.7)
text(48,0.17, labels = "136", cex = 0.7, col = "red")
text(56,0.17, labels = "136", cex = 0.7, col = "green")
text(66,0.17, labels = "133", cex = 0.7, col = "blue")
text(19,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(47,0.15, labels = "97", cex = 0.7, col = "red")
text(55,0.15, labels = "27", cex = 0.7, col = 'green')
text(65,0.15, labels = "14", cex = 0.7, col = 'blue')
dev.off()
