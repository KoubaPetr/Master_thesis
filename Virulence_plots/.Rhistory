virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
weights[i] <- proportion[longevity[i]-aai]
}
return(weights)
}
w_5 <- prepare_weights(proportion = virulence_proportion_aai_inf_5_aoi, longevity = inf_lifespan_aai_5, aai = 5)
w_15 <- prepare_weights(proportion = virulence_proportion_aai_inf_15_aoi, longevity = inf_lifespan_aai_15, aai = 15)
w_30 <- prepare_weights(proportion = virulence_proportion_aai_inf_30_aoi, longevity = inf_lifespan_aai_30, aai = 30)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
weighted.hist(x = inf_lifespan_aai_5, w = w_5, col = rgb(1,0,0,0.5))
weighted.hist(x = inf_lifespan_aai_15, w = w_15, col = rgb(0,0,1,0.5), add = T)
weighted.hist(x = inf_lifespan_aai_30, w = w_30, col =  rgb(0,1,0,0.5), add = T)
weighted.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5))#w = w_5,
weighted.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T)#w = w_15,
weighted.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T)#w = w_30,
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
weighted.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)#w = w_5,
weighted.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
weighted.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
### histograms of death distributions for respective aai classes
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
install.packages("weights")
### seriously whats up with the high death rate around the age of 40 for aai_5_inf (does it relate to the step in the survival?)
#require("plotrix")
require("weights")
#longevities
inf_lifespan_aai_5 <- (longevity_aai_5_inf - 5)
inf_lifespan_aai_15 <- (longevity_aai_15_inf - 15)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
#weights
virulence_proportion_aai_inf_5_aoi <-   virulence_aai_5[1:(max(longevity_aai_5_inf)-5)] / delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic)[1:(max(longevity_aai_5_inf)-5)]
virulence_proportion_aai_inf_15_aoi <-  virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] / delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[1:(max(longevity_aai_15_inf)-15)]
virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
weights[i] <- proportion[longevity[i]-aai]
}
return(weights)
}
w_5 <- prepare_weights(proportion = virulence_proportion_aai_inf_5_aoi, longevity = inf_lifespan_aai_5, aai = 5)
w_15 <- prepare_weights(proportion = virulence_proportion_aai_inf_15_aoi, longevity = inf_lifespan_aai_15, aai = 15)
w_30 <- prepare_weights(proportion = virulence_proportion_aai_inf_30_aoi, longevity = inf_lifespan_aai_30, aai = 30)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
wtd.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)#w = w_5,
wtd.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
wtd.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
# weighted.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)#w = w_5,
# weighted.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
# weighted.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
### histograms of death distributions for respective aai classes
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)#w = w_5,
wtd.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
wtd.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
wtd.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE, xlab = "xx")#w = w_5,
wtd.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
wtd.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)#w = w_5,
wtd.hist(x = inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
wtd.hist(x = inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)#w = w_5,
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)#w = w_15,
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)#w = w_30,
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
w_15
virulence_proportion_aai_inf_15_aoi
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
weights[i] <- proportion[(longevity[i]-aai)]
}
return(weights)
}
virulence_proportion_aai_inf_15_aoi>0
virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] >0
delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic) > delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic)
require("weights")
#longevities
inf_lifespan_aai_5 <- (longevity_aai_5_inf - 5)
inf_lifespan_aai_15 <- (longevity_aai_15_inf - 15)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
#weights
virulence_proportion_aai_inf_5_aoi <-   virulence_aai_5[1:(max(longevity_aai_5_inf)-5)] / delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic)[1:(max(longevity_aai_5_inf)-5)]
virulence_proportion_aai_inf_15_aoi <-  virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] / delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[1:(max(longevity_aai_15_inf)-15)]
virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
if(proportion>0){
weights[i] <- proportion[(longevity[i]-aai)]
}else{
weights[i] <- 0
}
}
return(weights)
}
w_5 <- prepare_weights(proportion = virulence_proportion_aai_inf_5_aoi, longevity = inf_lifespan_aai_5, aai = 5)
w_15 <- prepare_weights(proportion = virulence_proportion_aai_inf_15_aoi, longevity = inf_lifespan_aai_15, aai = 15)
w_30 <- prepare_weights(proportion = virulence_proportion_aai_inf_30_aoi, longevity = inf_lifespan_aai_30, aai = 30)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
### Plotting histograms of lifespans for different ages of infection TODO: weight the histogram by the ratio virulence/deathrate
### seriously whats up with the high death rate around the age of 40 for aai_5_inf (does it relate to the step in the survival?)
#require("plotrix")
require("weights")
#longevities
inf_lifespan_aai_5 <- (longevity_aai_5_inf - 5)
inf_lifespan_aai_15 <- (longevity_aai_15_inf - 15)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
#weights
virulence_proportion_aai_inf_5_aoi <-   virulence_aai_5[1:(max(longevity_aai_5_inf)-5)] / delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic)[1:(max(longevity_aai_5_inf)-5)]
virulence_proportion_aai_inf_15_aoi <-  virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] / delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[1:(max(longevity_aai_15_inf)-15)]
virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
### Plotting histograms of lifespans for different ages of infection TODO: weight the histogram by the ratio virulence/deathrate
### seriously whats up with the high death rate around the age of 40 for aai_5_inf (does it relate to the step in the survival?)
#require("plotrix")
require("weights")
#longevities
inf_lifespan_aai_5 <- (longevity_aai_5_inf - 5)
inf_lifespan_aai_15 <- (longevity_aai_15_inf - 15)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
#weights
virulence_proportion_aai_inf_5_aoi <-   virulence_aai_5[1:(max(longevity_aai_5_inf)-5)] / delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic)[1:(max(longevity_aai_5_inf)-5)]
virulence_proportion_aai_inf_15_aoi <-  virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] / delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[1:(max(longevity_aai_15_inf)-15)]
virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
if(proportion[(longevity[i]-aai)]>0){
weights[i] <- proportion[(longevity[i]-aai)]
}else{
weights[i] <- 0
}
}
return(weights)
}
w_5 <- prepare_weights(proportion = virulence_proportion_aai_inf_5_aoi, longevity = inf_lifespan_aai_5, aai = 5)
w_15 <- prepare_weights(proportion = virulence_proportion_aai_inf_15_aoi, longevity = inf_lifespan_aai_15, aai = 15)
w_30 <- prepare_weights(proportion = virulence_proportion_aai_inf_30_aoi, longevity = inf_lifespan_aai_30, aai = 30)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
length(proportion[(longevity[i]-aai)])
require("weights")
#longevities
inf_lifespan_aai_5 <- (longevity_aai_5_inf - 5)
inf_lifespan_aai_15 <- (longevity_aai_15_inf - 15)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
#weights
virulence_proportion_aai_inf_5_aoi <-   virulence_aai_5[1:(max(longevity_aai_5_inf)-5)] / delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic)[1:(max(longevity_aai_5_inf)-5)]
virulence_proportion_aai_inf_15_aoi <-  virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] / delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[1:(max(longevity_aai_15_inf)-15)]
virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
if(proportion[(longevity[i]-aai)]>0){
message("length",length(proportion[(longevity[i]-aai)]))
weights[i] <- proportion[(longevity[i]-aai)]
}else{
weights[i] <- 0
}
}
return(weights)
}
w_5 <- prepare_weights(proportion = virulence_proportion_aai_inf_5_aoi, longevity = inf_lifespan_aai_5, aai = 5)
w_15 <- prepare_weights(proportion = virulence_proportion_aai_inf_15_aoi, longevity = inf_lifespan_aai_15, aai = 15)
w_30 <- prepare_weights(proportion = virulence_proportion_aai_inf_30_aoi, longevity = inf_lifespan_aai_30, aai = 30)
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
if(proportion[(longevity[i]-aai)]>0){
weights[i] <- proportion[(longevity[i]-aai)]
}else{
weights[i] <- 0
}
}
return(weights)
}
require("weights")
#longevities
inf_lifespan_aai_5 <- (longevity_aai_5_inf - 5)
inf_lifespan_aai_15 <- (longevity_aai_15_inf - 15)
inf_lifespan_aai_30 <- (longevity_aai_30_inf - 30)
#weights
virulence_proportion_aai_inf_5_aoi <-   virulence_aai_5[1:(max(longevity_aai_5_inf)-5)] / delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic)[1:(max(longevity_aai_5_inf)-5)]
virulence_proportion_aai_inf_15_aoi <-  virulence_aai_15[1:(max(longevity_aai_15_inf)-15)] / delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[1:(max(longevity_aai_15_inf)-15)]
virulence_proportion_aai_inf_30_aoi <-  virulence_aai_30[1:(max(longevity_aai_30_inf)-30)] / delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic)[1:(max(longevity_aai_30_inf)-30)]
prepare_weights <- function(proportion, longevity, aai){
weights <- rep(0, length(longevity))
for (i in 1:length(longevity)) {
if(proportion[(longevity[i]-aai)]>0){
weights[i] <- proportion[(longevity[i]-aai)]
}else{
weights[i] <- 0
}
}
return(weights)
}
w_5 <- prepare_weights(proportion = virulence_proportion_aai_inf_5_aoi, longevity = inf_lifespan_aai_5, aai = 5)
w_15 <- prepare_weights(proportion = virulence_proportion_aai_inf_15_aoi, longevity = inf_lifespan_aai_15, aai = 15)
w_30 <- prepare_weights(proportion = virulence_proportion_aai_inf_30_aoi, longevity = inf_lifespan_aai_30, aai = 30)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
virulence_proportion_aai_inf_30_aoi
virulence_proportion_aai_inf_30_aoi[inf_lifespan_aai_30[5]-30]
virulence_proportion_aai_inf_30_aoi[[inf_lifespan_aai_30[5]-30]]
virulence_proportion_aai_inf_30_aoi[inf_lifespan_aai_30[5]-30][1]
length(virulence_proportion_aai_inf_30_aoi[inf_lifespan_aai_30[5]-30])
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
?seq()
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, breaks = rep(5,11), weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30,  weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)$breaks
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)$breaks
wtd.hist(x = inf_lifespan_aai_30, breaks = , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)$breaks
wtd.hist(x = inf_lifespan_aai_30, breaks = , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE)
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = 0.06)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = 0.06)
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
#histograms showing death distribution due too virulence only
#(significance of each death weighted by the ratio of virulence to total deathrate)
#FIX!!! It seems it is weighting the wrong axis!
?hist()
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.06))
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.06))
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.1))
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.1))
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.15))
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.15))
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12))
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend(legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7))
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7))
?legend
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
legend(legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7))
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7)
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(40,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.7)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 1.2)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 1.5)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 1.5)
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
setwd("~/Documents/Master_thesis/Virulence_plots")
pdf("Fitting_delta_inf_at_age_5.pdf")
## AaI = 5, inf
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_inf[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Infected_At_Age=5")
# Linear model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_linear), x = age_of_inf_5_axis), col = "yellow")
# Quadratic model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quadratic), x = age_of_inf_5_axis), col = "green")
# Cubic model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_cubic), x = age_of_inf_5_axis), col = "blue")
# Quartic model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_inf_quartic), x = age_of_inf_5_axis), col = "red")
legend(90,1, legend = c("Data", 'Linear model', "Quadratic model", "Cubic model", "4th order polynomial model"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
dev.off()
## AaI = 15, inf
pdf("Fitting_delta_inf_at_age_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_inf[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Infected_At_Age=15")
# Linear model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_linear), x = age_of_inf_15_axis), col = "yellow")
# Quadratic model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic), x = age_of_inf_15_axis), col = "green")
# Cubic model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_cubic), x = age_of_inf_15_axis), col = "blue")
# Quartic model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quartic), x = age_of_inf_15_axis), col = "red")
legend(95,1, legend = c("Data", 'Linear model', "Quadratic model", "Cubic model", "4th order polynomial model"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
dev.off()
## AaI = 30, inf
pdf("Fitting_delta_inf_at_age_30.pdf")
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_inf[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Infected_At_Age=30")
# Linear model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_linear), x = age_of_inf_30_axis), col = "yellow")
# Quadratic model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quadratic), x = age_of_inf_30_axis), col = "green")
# Cubic model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_cubic), x = age_of_inf_30_axis), col = "blue")
# Quartic model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_inf_quartic), x = age_of_inf_30_axis), col = "red")
legend(100,1, legend = c("Data", 'Linear model', "Quadratic model", "Cubic model", "4th order polynomial model"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
dev.off()
## AaI = 5, exp
pdf("Fitting_delta_exp_at_age_5.pdf")
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5")
# Linear model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_linear), x = age_of_inf_5_axis), col = "yellow")
# Quadratic model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quadratic), x = age_of_inf_5_axis), col = "green")
# Cubic model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_cubic), x = age_of_inf_5_axis), col = "blue")
# Quartic model
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
legend(90,1, legend = c("Data", 'Linear model', "Quadratic model", "Cubic model", "4th order polynomial model"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
dev.off()
## AaI = 15, exp
pdf("Fitting_delta_exp_at_age_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15")
# Linear model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_linear), x = age_of_inf_15_axis), col = "yellow")
# Quadratic model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quadratic), x = age_of_inf_15_axis), col = "green")
# Cubic model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_cubic), x = age_of_inf_15_axis), col = "blue")
# Quartic model
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "red")
legend(95,1, legend = c("Data", 'Linear model', "Quadratic model", "Cubic model", "4th order polynomial model"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
dev.off()
## AaI = 30, exp
pdf("Fitting_delta_exp_at_age_30.pdf")
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30")
# Linear model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_linear), x = age_of_inf_30_axis), col = "yellow")
# Quadratic model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quadratic), x = age_of_inf_30_axis), col = "green")
# Cubic model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_cubic), x = age_of_inf_30_axis), col = "blue")
# Quartic model
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "red")
legend(100,1, legend = c("Data", 'Linear model', "Quadratic model", "Cubic model", "4th order polynomial model"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
dev.off()
pdf("Virulences_age_of_infection_structured_same_model_for_same_infection_status.pdf")
plot(x = age_axis[1:(lifetime_threshold-4)], y = virulence_aai_5, xlab = "Age of infection [Days]", ylab = "Virulence", col = "red", type = "l")
lines(x = age_axis[1:(lifetime_threshold-14)], y = virulence_aai_15, col = "green")
lines(x = age_axis[1:(lifetime_threshold-29)], y = virulence_aai_30, col = "blue")
points(x = c(89, 78, 68), y = c(0.224, 0.095, 0.06), col = "black", pch = 20, cex = 1.3)
legend(0,0.32, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30", "Points mark the last\navailable datapoint for fitting"), col = c("red", "green", "blue", "black"), lty =c(1,1,1,NA) , pch = c(NA,NA,NA,20), cex = 0.7, pt.cex = 1.3)
text(20.2,0.17, labels = "Sample size for exposed:", cex = 0.7)
text(45,0.17, labels = "16", cex = 0.7, col = "red")
text(51,0.17, labels = "56", cex = 0.7, col = "green")
text(57,0.17, labels = "64", cex = 0.7, col = "blue")
text(20.5,0.15, labels = "Sample size for infecteds:", cex = 0.7)
text(45,0.15, labels = "97", cex = 0.7, col = "red")
text(51,0.15, labels = "27", cex = 0.7, col = 'green')
text(57,0.15, labels = "14", cex = 0.7, col = 'blue')
dev.off()
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE)
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend("topright", bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE, main = "Overall distribution of deaths")
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend("topright", bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE, main = "Overall distribution of deaths", xlab = "Age of infection [Days]")
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE, main = "Overall distribution of deaths", xlab = "Age of infection [Days]")
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend("topright", bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
pdf("Overall_distribution_of_deaths.pdf")
hist(inf_lifespan_aai_5, col = rgb(1,0,0,0.5), freq = FALSE, main = "Overall distribution of deaths", xlab = "Age of infection [Days]")
hist(inf_lifespan_aai_15, col = rgb(0,0,1,0.5), add = T, freq = FALSE)
hist(inf_lifespan_aai_30, col =  rgb(0,1,0,0.5), add = T, freq = FALSE)
legend("topright", bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
dev.off()
delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[5]
delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_inf_quadratic)[50]
virulence_aai_15[50]
pdf("Distribution_of_deaths_due_to_virulence.pdf")
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
dev.off()
wtd.hist(x = inf_lifespan_aai_5, weight = w_5, col = rgb(1,0,0,0.5), freq = FALSE, ylim = c(0,0.12), main = "Distributions of deaths due to infection", xlab = "Age of infection [days]", ylab = "Density")
wtd.hist(x = inf_lifespan_aai_15, breaks = seq(30,85, by = 5), weight = w_15, col = rgb(0,1,0,0.5), add = T, freq = FALSE)
wtd.hist(x = inf_lifespan_aai_30, breaks = seq(30,85, by = 5) , weight = w_30,col = rgb(0,0,1,0.5) , add = T, freq = FALSE)
legend(30,0.12, bty="n", legend = c("Age at infection = 5", "Age at infection = 15", "Age at infection = 30"), col = c("red", "green", "blue"), lty =c(1,1,1) , cex = 0.9, lwd = 2)
