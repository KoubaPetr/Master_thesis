likelihoods_control_linear <- c(optimized_likelihood_aai_5_control_linear, optimized_likelihood_aai_15_control_linear,optimized_likelihood_aai_30_control_linear)
likelihoods_control_quadratic <- c(optimized_likelihood_aai_5_control_quadratic, optimized_likelihood_aai_15_control_quadratic, optimized_likelihood_aai_30_control_quadratic)
likelihoods_control_cubic <- c(optimized_likelihood_aai_5_control_cubic, optimized_likelihood_aai_15_control_cubic, optimized_likelihood_aai_30_control_cubic)
likelihoods_control_quartic <- c(optimized_likelihood_aai_5_control_quartic, optimized_likelihood_aai_15_control_quartic, optimized_likelihood_aai_30_control_quartic)
LRT_lin_quadratic_exp <- 2*(likelihoods_exp_linear - likelihoods_exp_quadratic)
LRT_quadratic_cub_exp <- 2*(likelihoods_exp_quadratic - likelihoods_exp_cubic)
LRT_cub_quartic_exp <- 2*(likelihoods_exp_cubic - likelihoods_exp_quartic)
LRT_lin_quadratic_inf <- 2*(likelihoods_inf_linear - likelihoods_inf_quadratic)
LRT_quadratic_cub_inf <- 2*(likelihoods_inf_quadratic - likelihoods_inf_cubic)
LRT_cub_quartic_inf <- 2*(likelihoods_inf_cubic - likelihoods_inf_quartic)
LRT_lin_quadratic_control<- 2*(likelihoods_control_linear - likelihoods_control_quadratic)
LRT_quadratic_cub_control <- 2*(likelihoods_control_quadratic - likelihoods_control_cubic)
LRT_cub_quartic_control <- 2*(likelihoods_control_cubic - likelihoods_control_quartic)
pchisq(LRT_lin_quadratic_exp, df = 1, tail = FALSE)
pchisq(LRT_lin_quadratic_exp, df = 1, lower.tail = FALSE)
pchisq(LRT_quadratic_cubic_exp, df = 1, lower.tail = FALSE)
pchisq(LRT_quadratic_cub_exp, df = 1, lower.tail = FALSE)
pchisq(LRT_cub_quartic_exp, df = 1, lower.tail = FALSE)
pchisq(0, df = 1, lower.tail = FALSE)
pchisq(LRT_lin_quadratic_exp, df = 1, lower.tail = FALSE)
pchisq(LRT_quadratic_cub_exp, df = 1, lower.tail = FALSE)
pchisq(LRT_cub_quartic_exp, df = 1, lower.tail = FALSE)
pchisq(LRT_lin_quadratic_inf, df = 1, lower.tail = FALSE)
pchisq(LRT_quadratic_cub_inf, df = 1, lower.tail = FALSE)
pchisq(LRT_cub_quartic_inf, df = 1, lower.tail = FALSE) # for age at infection 5, best fit is the cubic one, otherwise quartic
pchisq(LRT_lin_quadratic_control, df = 1, lower.tail = FALSE)
pchisq(LRT_quadratic_cub_control, df = 1, lower.tail = FALSE)
pchisq(LRT_cub_quartic_control, df = 1, lower.tail = FALSE) # for age at infection 5, best fit is the cubic one, otherwise quartic
##### Plotting ------------------------------------------------------------------------------------
### Comparing exposed and control populations
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", cex = 2)
##### Plotting ------------------------------------------------------------------------------------
### Comparing exposed and control populations
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", cex = 3)
##### Plotting ------------------------------------------------------------------------------------
### Comparing exposed and control populations
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 2)
##### Plotting ------------------------------------------------------------------------------------
### Comparing exposed and control populations
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5")
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", lwd = 3, col = "red")
# Cubic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_cubic), x = age_of_inf_5_axis), col = "yellow")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "green")
# Cubic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_cubic), x = age_of_inf_5_axis), col = "blue")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Cubic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_cubic), x = age_of_inf_5_axis), col = "yellow")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "green")
# Cubic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_cubic), x = age_of_inf_5_axis), col = "blue")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
legend(90,1, legend = c("Data exposed", "Data control",'Cubic model control', "Quartic model control", "Cubic model Exposed", "Quartic model exposed"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
legend("lowerleft", legend = c("Data exposed", "Data control",'Cubic model control', "Quartic model control", "Cubic model Exposed", "Quartic model exposed"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
### Control plots
pdf("Fitting_delta_inf_at_age_5.pdf")
legend("bottomleft", legend = c("Data exposed", "Data control",'Cubic model control', "Quartic model control", "Cubic model Exposed", "Quartic model exposed"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Cubic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_cubic), x = age_of_inf_5_axis), col = "yellow")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "green")
# Cubic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_cubic), x = age_of_inf_5_axis), col = "blue")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control",'Cubic model control', "Quartic model control", "Cubic model Exposed", "Quartic model exposed"), col = c("black", "yellow", "green", "blue", "red"), lty = 1, cex = 0.8)
##### Plotting ------------------------------------------------------------------------------------
### Comparing exposed and control populations
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Cubic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_cubic), x = age_of_inf_5_axis), col = "yellow")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "green")
# Cubic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_cubic), x = age_of_inf_5_axis), col = "blue")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "green")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "black", "red", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "black")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "black", "red", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "black", "red", "red"), lty = 1, cex = 0.8)
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lty = 1, cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lty = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Quartic model control", "Quartic model exposed"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_control[5:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
## Age at infection = 15
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_control[15:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_control[15:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_control[15:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
## Age at infection = 30
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_control[30:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_control[30:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
## Age at infection = 15
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_control[15:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_control[15:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_control[30:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
sum(host_longevity_control>30)
host_longevity_control
str(control_population)
str(control_population$HostLongevity)
sum(host_longevity_control>30)
survivals_aai_5__control <- c(rep(0,lifetime_threshold+1))
survivals_aai_15__control <- c(rep(0,lifetime_threshold+1))
survivals_aai_30__control <- c(rep(0,lifetime_threshold+1))
for (x in 5:lifetime_threshold){
survivals_aai_5_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>5)
}
for (x in 15:lifetime_threshold){
survivals_aai_15_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>15)
}
for (x in 30:lifetime_threshold) {
survivals_aai_30_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>30)
}
survivals_aai_5_control <- c(rep(0,lifetime_threshold+1))
survivals_aai_15_control <- c(rep(0,lifetime_threshold+1))
survivals_aai_30_control <- c(rep(0,lifetime_threshold+1))
for (x in 5:lifetime_threshold){
survivals_aai_5_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>5)
}
for (x in 15:lifetime_threshold){
survivals_aai_15_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>15)
}
for (x in 30:lifetime_threshold) {
survivals_aai_30_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>30)
}
plot(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_control[30:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
## Age at infection = 30
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
for (x in 4:lifetime_threshold){
survivals_aai_5_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>5)
}
for (x in 14:lifetime_threshold){
survivals_aai_15_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>15)
}
for (x in 29:lifetime_threshold) {
survivals_aai_30_control[x+1] <- sum(host_longevity_control>x)/ sum(host_longevity_control>30)
}
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, col = "red")
# Quartic model Control
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
lot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = stepfun(age_axis[15:lifetime_threshold],survivals_aai_15_exp[15:lifetime_threshold]), xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
## Age at infection = 15
plot(x = age_axis[15:lifetime_threshold], y = stepfun(age_axis[16:lifetime_threshold],survivals_aai_15_exp[15:lifetime_threshold]), xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
plot(x = age_axis[15:lifetime_threshold], y = stepfun(age_axis[16:lifetime_threshold],survivals_aai_15_exp[15:lifetime_threshold]), xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
survivals_aai_5_control
stepfun(survivals_aai_5_control)
#stepfun(survivals_aai_5_control)
?stepfun
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = stepfun(age_axis[5:lifetime_threshold], c(1,survivals_aai_5_exp[5:lifetime_threshold])), xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
length(age_axis[5:lifetime_threshold])
length(survivals_aai_5_exp[5:lifetime_threshold])
length(stepfun(age_axis[5:lifetime_threshold],survivals_aai_5_exp[5:lifetime_threshold]))
length(stepfun(age_axis[5:lifetime_threshold],c(1,survivals_aai_5_exp[5:lifetime_threshold])))
?stepfun
f <-stepfun(age_axis[5:lifetime_threshold],c(1,survivals_aai_5_exp[5:lifetime_threshold]))
str(f)
f <-stepfun(x=age_axis[5:lifetime_threshold],y=c(1,survivals_aai_5_exp[5:lifetime_threshold], ties = "ordered", right = FALSE)
str(f)
f <-stepfun(x=age_axis[5:lifetime_threshold],y=c(1,survivals_aai_5_exp[5:lifetime_threshold],)
str(f)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "s", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red", type = "s")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", type = "s", lwd = 3)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "s", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, type = "s", col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "s", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red", type = "s")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
## Age at infection = 15
plot(x = age_axis[15:lifetime_threshold], y = stepfun(age_axis[15:lifetime_threshold],survivals_aai_15_exp[15:lifetime_threshold]), xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
# Quartic model Control
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
## Age at infection = 30
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
# Quartic model Control
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
## Age at infection = 30
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=30", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
# Quartic model Control
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_control_quartic), x = age_of_inf_30_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[30:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[30:lifetime_threshold], parameters = optimized_parameters_aai_30_exp_quartic), x = age_of_inf_30_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = stepfun(age_axis[15:lifetime_threshold],survivals_aai_15_exp[15:lifetime_threshold]), xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=15", type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
# Quartic model Control
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_control_quartic), x = age_of_inf_15_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[15:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[15:lifetime_threshold], parameters = optimized_parameters_aai_15_exp_quartic), x = age_of_inf_15_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red", xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "l", lwd = 3)
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Quartic model exposed", "Quartic model control"), col = c("black", "red"), lwd = c(1,1), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "s", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, col = "red", type = "s")
legend("bottomleft", legend = c("Data exposed", "Data control"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_exp[5:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival_Exposed_At_Age=5", type = "s", lwd = 3)
lines(x = age_axis[5:lifetime_threshold], y = survivals_aai_5_control[5:lifetime_threshold], lwd = 3, type = "s", col = "red")
# Quartic model Control
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_control_quartic), x = age_of_inf_5_axis), col = "red")
# Quartic model Exposed
lines(x = age_axis[5:lifetime_threshold], y = survival_model(delta = delta(age = age_axis[5:lifetime_threshold], parameters = optimized_parameters_aai_5_exp_quartic), x = age_of_inf_5_axis), col = "black")
legend("bottomleft", legend = c("Data exposed", "Data control", "Quartic model control", "Quartic model exposed"), col = c("black", "red", "black", "red"), lwd = c(3,3,1,1), cex = 0.8)
setwd("~/Documents/Master_thesis/Survival_data_aai_structured")
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylim =1 ,ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylim = 1 ,ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylim = 1.0 ,ylab = "Survival[fraction]",type = "s", lwd = 3)
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]",ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]",ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
str(survivals_aai_15_exp[15:lifetime_threshold])
str(survivals_aai_15_control[15:lifetime_threshold])
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]",type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival [fraction]", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 30)", "Data control (since age 30)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
pdf("Survival_data_aai_30.pdf")
plot(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_exp[30:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival [fraction]", type = "s", lwd = 3)
lines(x = age_axis[30:lifetime_threshold], y = survivals_aai_30_control[30:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 30)", "Data control (since age 30)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]", type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
survivals_aai_15_control[15:lifetime_threshold]
survivals_aai_15_exp[15:lifetime_threshold]
is.NA(survivals_aai_15_exp[15:lifetime_threshold])
is.na(survivals_aai_15_exp[15:lifetime_threshold])
is.na(survivals_aai_15_control[15:lifetime_threshold])
is.na(age_axis[15:lifetime_threshold])
plot("Survival_data_aai_15.pdf")
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]", type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
dev.off()
plot(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_exp[15:lifetime_threshold], xlab = "Age [Days]", ylab = "Survival[fraction]", type = "s", lwd = 3)
lines(x = age_axis[15:lifetime_threshold], y = survivals_aai_15_control[15:lifetime_threshold], lwd = 3, type = "s", col = "red")
legend("bottomleft", legend = c("Data exposed (at age 15)", "Data control (since age 15)"), col = c("black", "red"), lwd = c(3,3), cex = 0.8)
